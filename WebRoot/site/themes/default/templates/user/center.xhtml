<ui:composition template="../pageCenter.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pm="http://primefaces.org/mobile"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:o="http://omnifaces.org/ui"
	xmlns:sec="http://www.springframework.org/security/facelets/tags"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
	<ui:define name="content">
		<!-- <h:outputScript library="primefaces" name="jquery/jquery-plugins.js"
			target="head" />
		<h:outputStylesheet library="primefaces" name="primefaces.css"
			target="head" />
		<link href="#{tplVars.themeStylePath}/center.css" type="text/css"
			rel="stylesheet" /> -->
		<script type="text/javascript" src="#{path}/include/js/datepicker.js"></script>
		<script type="text/javascript" >
		//董 ，防止浏览器后退！这个功能是为了防止投资后浏览器后退功能！待测试~
		 javascript:window.history.forward(1); //我目前先用着这个
		</script>
		<link type="text/css" rel="stylesheet" href="#{tplVars.themeStylePath}/css/usercenter_me.css" />
		<link type="text/css" rel="stylesheet" href="#{tplVars.themeStylePath}/css/usercenter_commom.css" />
		<div id="main">
			<div class="main_inner">
				<!-- <p style=" padding-bottom:34px;"><a href="#{path}/" style="color:#666666">首页</a> > <a href="#" style="color:#666666">我的账户</a></p> -->
				<div class="main_con">
                	<div class="mainyy_l">
				<ul class="mlnav">
					<li class="hover"><a class="li01" href="#{path}/user/center"
						id="CC1_1">我的账户</a></li>
					<li><a class="li02" href="javascript:void(0)" id="CC1_2"
						onclick="OpenClose1('C1_2')">资金管理</a>
						<ul id="C1_2" style="display:none"  class="sub s1">
							<li><a href="#{request.contextPath}/user/myCashFlow">交易记录</a></li>
							<li><a href="#{request.contextPath}/user/recharge">账户充值</a></li>
							<li><a href="#{request.contextPath}/user/withdraw">账户提现</a></li>
						</ul></li>
					<li><a class="li03" href="javascript:void(0)" id="CC1_3"
						onclick="OpenClose1('C1_3')">理财管理</a>
						<ul id="C1_3" style="display:none"  class="sub s1">
							<li><h:link outcome="pretty:user_invest_repaying"
									value="我的投资"></h:link></li>
							<li><a href="#{request.contextPath}/user/transfer/purchased">债权转让</a></li>
							<!-- 							<li><a href="个人中心-理财管理-理财统计.html">理财统计</a></li> -->
							<!-- <sec:ifAllGranted roles="AUTO_INVEST">
								<li><a href="#{request.contextPath}/user/auto_invest">自动投标</a></li>
							</sec:ifAllGranted> -->
							<li><a href="#{request.contextPath}/user/auto_invest">自动投标</a></li>
						</ul></li>
					<li><a class="li04" href="javascript:void(0)" id="CC1_4"
						onclick="OpenClose1('C1_4')">借款管理</a>
						<ul id="C1_4" style="display:none" class="sub s1">
							<li><h:link outcome="pretty:user_loan_repaying" value="我的借款"></h:link></li>
							<li><h:link outcome="pretty:user_loan_applying-p2p"
									value="借款申请查询"></h:link></li>
							<li><h:link outcome="pretty:user_loan_autoRepayment" value="自动扣款"></h:link></li>
							<!--<li><h:link outcome="pretty:myTrades"
									value="我的配资"></h:link></li>
							 							<li><a href="个人中心-借款管理-借款统计.html">借款统计</a></li> -->
						</ul></li>
					<li><a class="li05" href="javascript:void(0)" id="CC1_5"
						onclick="OpenClose1('C1_5')">账户管理</a>
						<ul id="C1_5" style="display:none" class="sub s1">
							<li><a
								href="#{request.contextPath}/user/get_investor_permission">个人信息</a></li>
							<!-- 							<li><a href="#{request.contextPath}/user/managemyInfo">认证信息</a></li> -->
							<li><a href="#{request.contextPath}/user/accountSafe">安全信息</a></li>
							<ui:fragment
								rendered="#{configHome.getConfigValue('ipspay_enable') != '1'}">
							<li><a href="#{request.contextPath}/user/bankCardList">银行卡信息</a></li>
							</ui:fragment>
						</ul></li>
					<li><a class="li06" href="javascript:void(0)" id="CC1_6"
						onclick="OpenClose1('C1_6')">互动管理</a>
						<ul id="C1_6" style="display:none" class="sub s1">
							<li><a href="#{request.contextPath}/user/message">站内信</a></li>
							<!-- 暂时去掉Zhangwq20150805 -->
							<li><a href="#{request.contextPath}/user/messageTypeSet">通知设置</a></li>
						</ul></li>
					<!-- 体验活动菜单 -->
					<li><a class="li08" href="javascript:void(0)" id="CC1_8"
						onclick="OpenClose1('C1_8')">平台活动</a>
						<ul id="C1_8" style="display:none" class="sub s1">
							<li>
							<h:link outcome="pretty:experience" value="体验金"></h:link>
							</li>
						</ul></li>
					<li><a class="li07" href="javascript:void(0)" id="CC1_7"
						onclick="OpenClose1('C1_7')">推荐管理</a>
						<ul id="C1_7" style="display:none" class="sub s1">
						<!-- 暂时屏蔽积分功能Zhangwq20150806 -->
							<!-- <li><a href="#{request.contextPath}/user/my-point-history">积分</a></li> -->
							<li><a href="#{request.contextPath}/user/my-presentee">推荐管理</a></li>
							<!-- 							<li><a href="#">VIP</a></li> -->
						</ul></li>
				</ul>
					</div>
					<ui:insert name="center_right">
						<sec:ifNotGranted roles="INVESTOR">
			<script>
				$.dialog
						.alert(
								'您尚未拥有投资权限，请先进行实名认证!',
								function() {
									window.location.href = "#{path}/user/get_investor_permission";
								});
			</script>
				</sec:ifNotGranted>
						 <div class="main_r">
						 <div class="m_t">
                		<ui:include src="userCenterTop.xhtml"></ui:include>
                		</div>
                		<div class="m_m">
                			<ul>
	                        	<li>
	                            	<img title="资产总额=账户可用金额+冻结金额+待收本息" src="#{tplVars.themeImagePath}/img/img20.png"/>资产总额<br/>
	                                <span class="r"></span><span class="num"><h:outputText
										value="#{billStatistics.getBalanceByUserId(loginUserInfo.loginUserId)+billStatistics.getFrozenMoneyByUserId(loginUserInfo.loginUserId)+investStatistics.getReceivableInterest(loginUserInfo.loginUserId)+investStatistics.getReceivableCorpus(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText></span>
	                            </li>
	                            <li class="shuzi">=</li>
	                            <li>
	                            	<img title="账户可用金额" src="#{tplVars.themeImagePath}/img/img20.png"/>可用金额<br/>
	                                <span class="r"></span><span class="num"><h:outputText
										value="#{billStatistics.getBalanceByUserId(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText></span>
	                            </li>
	                            <li class="shuzi">+</li>
	                            <li>
	                            	<img title="待收金额=待收本金+待收利息" src="#{tplVars.themeImagePath}/img/img20.png"/>待收本息<br/>
	                                <span class="r"></span><span class="num">
	                                <h:outputText value="#{investStatistics.getReceivableCorpus(loginUserInfo.loginUserId)+investStatistics.getReceivableInterest(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText></span>
	                            </li>
	                            <li class="shuzi">+</li>
	                            <li>
	                            	<img title="账户冻结金额" src="#{tplVars.themeImagePath}/img/img20.png"/>冻结金额<br/>
	                                <span class="r"></span><span class="num"><h:outputText
										value="#{billStatistics.getFrozenMoneyByUserId(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText></span>
	                            </li>
	                           <!--  <li class="shuzi">+</li>
	                            <li>
	                            	<img src="#{tplVars.themeImagePath}/img/img20.png"/>借款待还<br/>
	                                <span class="r"></span><span class="num">￥<h:outputText
									value="#{loanStatistics.getWaitRepayMoney(loginUserInfo.loginUserId)}">
									<f:convertNumber minFractionDigits="2"/>
								</h:outputText></span>
	                            </li> -->
	                            <div class="clear"></div>
	                        </ul>
                		</div>
						<!--理财账户 -->
						<div class="m_b">
						
                    		<div class="licai">
                    			<div class="licai_l">
                        		<p class="lc_l">理财账户</p>
                                <p class="lc_r">已赚取利息<span><h:outputText
										value="#{investStatistics.getReceivedInterest(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText></span>元</p>
                                <div class="clear"></div>
	                            </div>
	                            <div class="licai_r">
	                        		<a href="#{request.contextPath}/user/invest/repaying" style=" margin-right:20px;color:#bfbfbf; ">查看全部债权</a><a href="#" style=" color:#bfbfbf;"><!--回款日历（假的）--></a>
	                            </div>
	                            <div class="clear"></div>
                    		</div>
                    		
                    		<div class="m_b_inf">
                            	<div class="inf1">
                                    <table width="764" border="1" bordercolor="black" cellspacing="0" >
                                        <tr class="tr_1">                
                                            <td class="td_1">累计投资额</td>
                                            <td class="td_2">预期总收益</td>
                                            <td class="td_3">已收本金</td>
                                            <td class="td_4">待收本金</td>
                                            <td class="td_5">已收利息 </td>
                                            <td class="td_6">待收利息</td>
                                        </tr>
                                        <tr class="tr_2">
                                            <td class="td_1"><h:outputText
										value="#{investStatistics.getReceivedCorpus(loginUserInfo.loginUserId)+investStatistics.getReceivableCorpus(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText>元</td>
                                            <td class="td_2"><h:outputText
										value="#{investStatistics.getReceivedInterest(loginUserInfo.loginUserId)+investStatistics.getReceivableInterest(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText>元</td>
                                            <td class="td_3"><h:outputText
										value="#{investStatistics.getReceivedCorpus(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText>元</td>
                                            <td class="td_4"><h:outputText
										value="#{investStatistics.getReceivableCorpus(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText>元</td>
                                            <td class="td_5"><h:outputText
										value="#{investStatistics.getReceivedInterest(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText>元</td>
                                            <td class="td_6"><h:outputText
										value="#{investStatistics.getReceivableInterest(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText>元</td>
                                         </tr>
                                    </table>
                            </div>			
                        </div>
                        
                        
                        <div class="licai">
                        	<div class="licai_l">
                        		<p class="lc_l">借款账户</p>
                                <p class="lc_r">待还总金额<span>￥<h:outputText
									value="#{loanStatistics.getWaitRepayMoney(loginUserInfo.loginUserId)}">
									<f:convertNumber minFractionDigits="2"/>
								</h:outputText></span>元</p>
                                <div class="clear"></div>
                            </div>
                            <div class="licai_r">
                        		<a href="#{request.contextPath}/user/loan/repaying" style=" margin-right:20px;color:#bfbfbf;">查看全部借款</a><a href="#" style=" color:#bfbfbf;"><!--还款日历（假的）--></a>
                            </div>
                            <div class="clear"></div>
                        </div>
                        <div class="m_b_inf">
                            <div class="inf1">
                            	<table width="764" border="1" bordercolor="black" cellspacing="0" >
                                        <tr class="tr_1">                
                                            <td class="td_1">逾期金额</td>
                                            <td class="td_2">待还金额</td>
                                            <td class="td_3">本月待还金额</td>
                                            <td class="td_4">本月待还笔数</td>
                                        </tr>
                                        <tr class="tr_2">
                                            <td class="td_1"><h:outputText
									value="#{loanStatistics.getWaitRepayMoney(loginUserInfo.loginUserId, now)}">
									<f:convertNumber minFractionDigits="2" />
								</h:outputText></td>
                                            <td class="td_2"><h:outputText
									value="#{loanStatistics.getWaitRepayMoney(loginUserInfo.loginUserId)}">
									<f:convertNumber minFractionDigits="2"/>
								</h:outputText></td>
                                            <td class="td_3"><h:outputText
									value="#{loanStatistics.getWaitRepayMoney(loginUserInfo.loginUserId, ldm)}">
									<f:convertNumber minFractionDigits="2" />
								</h:outputText></td>
                                            <td class="td_4"><h:outputText
									value="#{loanStatistics.getWaitRepayCount(loginUserInfo.loginUserId, ldm)}">
								</h:outputText></td>
                                         </tr>
                                    </table>
                            </div>			
                        </div>
                        
                    	</div>
                    	
						</div>
					<div class="clear"></div>
					</ui:insert>
				</div>
			</div>
			
		
		
	

					<!-- <div class="center_zj">
						<div class="center_zj_01">
							<p>
								<img title="累计投资额=回收本金+待收本金"
									src="#{tplVars.themeImagePath}/img20.png" /> 累计投资额： <span>
									<h:outputText
										value="#{investStatistics.getReceivedCorpus(loginUserInfo.loginUserId)+investStatistics.getReceivableCorpus(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText>
								</span>
							</p>
							<p>
								<img title="预期总收益=回收利息+待收利息"
									src="#{tplVars.themeImagePath}/img20.png" /> 预期总收益： <span>
									<h:outputText
										value="#{investStatistics.getReceivedInterest(loginUserInfo.loginUserId)+investStatistics.getReceivableInterest(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText>
								</span>
							</p>
						</div>
						<div class="center_zj_01 center_zj_02">
							<p>
								<img title="已收本金" src="#{tplVars.themeImagePath}/img20.png" />
								已收本金： <span> <h:outputText
										value="#{investStatistics.getReceivedCorpus(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText>
								</span>
							</p>
							<p>
								<img src="#{tplVars.themeImagePath}/img20.png" title="已收利息" />
								已收利息： <span> <h:outputText
										value="#{investStatistics.getReceivedInterest(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText>
								</span>

							</p>
						</div>
						<div class="center_zj_01 center_zj_03">
							<p>
								<img title="待收本金" src="#{tplVars.themeImagePath}/img20.png" />
								待收本金： <span> <h:outputText
										value="#{investStatistics.getReceivableCorpus(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText>

								</span>
							</p>
							<p>
								<img src="#{tplVars.themeImagePath}/img20.png" title="待收收益" />
								待收利息： <span> <h:outputText
										value="#{investStatistics.getReceivableInterest(loginUserInfo.loginUserId)}">
										<f:convertNumber type="currency" />
									</h:outputText>
								</span>
							</p>
						</div>
						<div class="clear"></div>
					</div>
					<div class="slideBox">
						<div class="hd">
							<ul class="slidings">
								<li class="hover" id="two1"><a href="javascript:void(0)">最新投资</a></li>
								<li id="two2"><a href="javascript:void(0)">最近借款</a></li>
							</ul>
							<div class="bd">
								<div id="con_two_1" class="slidnr">
									<h:link styleClass="more" outcome="pretty:user_invest_repaying"
										value="查看更多>>"></h:link>
									<table width="786" border="0" cellspacing="0" cellpadding="0"
										class="tab">
										<tr>
											<td width="196" align="left" class="tab01 tab04">项目名称</td>
											<td width="137" align="center" class="tab01">投资金额</td>
											<td width="72" align="center" class="tab01">利率</td>
											<td width="150" align="center" class="tab01">状态</td>
											<td width="215" align="center" class="tab01">投资时间</td>
										</tr>
										<f:event type="preRenderComponent"
											listener="#{investList.example.user.setUsername(loginUserInfo.loginUserId)}"></f:event>
										<f:event type="preRenderComponent"
											listener="#{investList.setPageSize(6)}"></f:event>
										<f:event type="preRenderComponent"
											listener="#{investList.addOrder('time','desc')}"></f:event>
										<ui:repeat var="invest" value="#{investList.lazyModelData}"
											varStatus="status">
											<tr class="#{status.index%2==0?'tab02':''} bg">
												<td align="left" class="tab02 tab04"><a target="_blank"
													href="#{path}/loan/#{invest.loan.id}"
													title="#{invest.loan.name}(#{invest.id})">#{stringHome.ellipsis(invest.loan.name,10)}</a></td>
												<td align="center" class="tab02"><h:outputText
														value="#{invest.money}">
														<f:convertNumber />
													</h:outputText></td>
												<td align="center" class="tab02"><h:outputText
														value="#{invest.rate}">
														<f:convertNumber type="percent" minFractionDigits="2" />
													</h:outputText></td>
												<td align="center" class="tab02">#{dictUtil.getValue('invest_status',
													invest.status)}</td>
												<td align="center" class="tab02"><h:outputText
														value="#{invest.time}">
														<f:convertDateTime pattern="yyyy-MM-dd HH:mm:ss"
															timeZone="GMT+8" locale="cn" />
													</h:outputText></td>
											</tr>
										</ui:repeat>
									</table>

								</div>
								<div id="con_two_2" class="slidnr sliding_yc">
									<h:link styleClass="more" outcome="pretty:user_loan_repaying"
										value="查看更多>>"></h:link>
									<table width="786" border="0" cellspacing="0" cellpadding="0"
										class="tab">
										<tr>
											<td width="156" align="left" class="tab01 tab04">项目名称</td>
											<td width="137" align="center" class="tab01">借款金额</td>
											<td width="72" align="center" class="tab01">利率</td>
											<td width="66" align="center" class="tab01">状态</td>
										</tr>
										<f:event type="preRenderComponent"
											listener="#{loanList.example.user.setId(loginUserInfo.loginUserId)}"></f:event>
										<f:event type="preRenderComponent"
											listener="#{loanList.setPageSize(6)}"></f:event>
										<f:event type="preRenderComponent"
											listener="#{loanList.addOrder('loan.commitTime','desc')}"></f:event>
										<ui:repeat var="loan" value="#{loanList.lazyModelData}"
											varStatus="status">
											<tr class="#{status.index%2==0?'tab02':''} bg">
												<td align="left" class="tab02 tab04"><a target="_blank"
													href="#{path}/loan/#{loan.id}"
													title="#{loan.name}(#{loan.id})">#{stringHome.ellipsis(loan.name,10)}</a></td>
												<td align="center" class="tab02"><h:outputText
														value="#{loan.loanMoney}">
														<f:convertNumber />
													</h:outputText></td>
												<td align="center" class="tab02"><h:outputText
														value="#{loan.rate}">
														<f:convertNumber type="percent" minFractionDigits="2" />
													</h:outputText></td>
												<td align="center" class="tab02">#{dictUtil.getValue('loan',loan.status)}</td>
											</tr>
										</ui:repeat>
									</table>

								</div>
							</div>
						</div>
					</div>
					新客户体验项目 放在了单独页面
					
				</div>
			</ui:insert>
			<div class="clear"></div>
			
			
			 -->
			
			
			
			
			
			
		</div>
		<script>
			if ('#{activeCenterMenuUrl}') {
				var selected = $("a[href='#{path}#{activeCenterMenuUrl}']");
				selected.addClass("hover");
				selected.parent().parent().prev().addClass("hover");
				selected.parent().parent().show();
			} else {
				$('#CC1_1').addClass("hover");
			}

			function OpenClose1(CID) {
				$(".mlnav ul").hide();
				$('#' + CID).show();
			}

			jQuery(".slideBox").slide({
				trigger : "click",
				titOnClassName : "hover"
			});
		</script>
		<p:tooltip globalSelector="img"></p:tooltip>
	</ui:define>
</ui:composition>